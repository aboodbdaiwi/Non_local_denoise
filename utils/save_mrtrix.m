function save_mrtrix(data,filename,NSA)
    image.data=data;
    image.vox=[1.25,1.25,1.25];
%     dw_scheme=[0,0,0,0
%                -0.333333,0.666667 ,-0.666667 ,2000;
%               -0.666667 ,0.333333, 0.666667 ,2000;
%                0.666667, 0.666667,0.333333,2000;
%               -0.707107,0.707107,0,2000;
%              0,0.707107,0.707107,2000;
%              0.707107,0,0.707107,2000;];
%     image.dw_scheme=repmat(dw_scheme,[NSA,1]);
    write_mrtrix(image,filename);
end
%     dw_scheme=[0,0,0,0
%                -0.333333,0.666667 ,-0.666667 ,1000;
%               -0.666667 ,0.333333, 0.666667 ,1000;
%                0.666667, 0.666667,0.333333,1000;
%               -0.707107,0.707107,0,1000;
%              0,0.707107,0.707107,1000;
%              0.707107,0,0.707107,1000;
%                             -0.333333,0.666667 ,-0.666667 ,2000;
%               -0.666667 ,0.333333, 0.666667 ,2000;
%                0.666667, 0.666667,0.333333,2000;
%               -0.707107,0.707107,0,2000;
%              0,0.707107,0.707107,2000;
%              0.707107,0,0.707107,2000;
%                             -0.333333,0.666667 ,-0.666667 ,3000;
%               -0.666667 ,0.333333, 0.666667 ,3000;
%                0.666667, 0.666667,0.333333,3000;
%               -0.707107,0.707107,0,3000;
%              0,0.707107,0.707107,3000;
%              0.707107,0,0.707107,3000;];
% 
% 
%     dw_scheme=[0,0,0,0
%                -0.333333,0.666667 ,-0.666667 ,2000;
%               -0.666667 ,0.333333, 0.666667 ,2000;
%                0.666667, 0.666667,0.333333,2000;
%               -0.707107,0.707107,0,2000;
%              0,0.707107,0.707107,2000;
%              0.707107,0,0.707107,2000;];